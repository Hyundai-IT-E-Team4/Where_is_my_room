<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.org.team4.dao.UserDAO">

	<select id="getUser" parameterType="LoginDTO"
		resultType="UserDTO">
		select *
		from users
		where email=#{email} and
			password=#{password}
	</select>

	<select id="registerUser" statementType="CALLABLE"
		parameterType="RegisterDTO">
		{
		CALL user_pack.users_register(
			#{password},
			#{name},
			#{nickname},
			#{email} || '@' || #{textEmail},
			#{gender}
		)
		}
	</select>

	<select id="withdrawUser" parameterType="LoginDTO" resultType="long">
		update users set 
			nickname = null, 
			email = null
    	where email = #{email} and 
    		password = #{password}
	</select>
	
	<select id="checkNickname" parameterType="String" resultType="int">
		select count(*)
		from users
		where nickname=#{nickname} 
	</select>

</mapper>

